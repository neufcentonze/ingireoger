<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    <%= title || "Djelo" %>
  </title>
  <link rel="stylesheet" href="/style/main.css" />
  <link rel="stylesheet" href="/style/header.css" />
  <link rel="stylesheet" href="/style/sidebar.css" />
</head>

<body>

  <!-- üîù HEADER -->
  <%- include('../partials/header') %>

    <!-- üß± WRAPPER PRINCIPAL -->
    <main class="main-wrapper">
      <!-- üìÇ SIDEBAR -->
      <%- include('../partials/sidebar') %>

        <!-- üì¶ CONTENU PRINCIPAL -->
        <div class="main-content">
          <%- body %>
        </div>
    </main>

    <!-- ‚¨áÔ∏è FOOTER -->
    <footer class="footer">
      <p>&copy; 2025 - Tous droits r√©serv√©s</p>
    </footer>

    <!-- üîß JS pour sidebar -->
    <script>
      function isMobile() {
        return window.innerWidth <= 768;
      }

      document.addEventListener('DOMContentLoaded', () => {
        const sidebar = document.querySelector('.sidebar');
        const toggleSidebarBtn = document.getElementById('toggleSidebar');

        // üì± au chargement : sidebar r√©duite
        if (isMobile()) {
          sidebar?.classList.add('sidebar--collapsed');
        }

        // ‚ò∞ Toggle button
        toggleSidebarBtn?.addEventListener('click', () => {
          if (isMobile()) {
            sidebar?.classList.toggle('hidden-mobile');
          } else {
            sidebar?.classList.toggle('sidebar--collapsed');
          }
        });

        // üìÇ Gestion du clic sur une cat√©gorie
        document.querySelectorAll('.sidebar-toggle').forEach(el => {
          el.addEventListener('click', (e) => {
            const id = el.dataset.id;
            const link = el.dataset.link;

            if (isMobile()) {
              window.location.href = link;
              return;
            }

            if (sidebar.classList.contains('sidebar--collapsed')) {
              // üß† Si sidebar r√©duite, on l'agrandit
              sidebar.classList.remove('sidebar--collapsed');
              // Puis on toggle l'ouverture du sous-menu apr√®s un petit d√©lai
              setTimeout(() => {
                const submenu = document.getElementById('submenu-' + id);
                submenu?.classList.toggle('open');
              }, 150); // attendre que la sidebar s‚Äôouvre (transition)
            } else {
              // Sidebar normale ‚Üí juste toggle du sous-menu
              const submenu = document.getElementById('submenu-' + id);
              submenu?.classList.toggle('open');
            }

            // Annule la navigation par d√©faut
            e.preventDefault();
          });
        });
      });
    </script>
</body>

</html>